easyblock = 'CMakeMake'

name = 'PSI4'
version = '1.3.2'
versionsuffix = '-Python-%(pyver)s'

homepage = 'http://www.psicode.org/'
description = """PSI4 is an open-source suite of ab initio quantum chemistry
 programs designed for efficient, high-accuracy simulations of a variety of
 molecular properties. We can routinely perform computations with more than
 2500 basis functions running serially or in parallel."""

toolchain = {'name': 'iimkl', 'version': '2020a'}

source_urls = ['https://github.com/psi4/psi4/archive/']
sources = ['v%(version)s.tar.gz']
checksums = ['ed76c67803b6420f35f57a6dd31c47108b9145b8c9fced5c94cdc179f6b5fbf3']

#multi_deps = {'Python': ['3.6', '3.7', '3.8']}
dependencies = [
    ('Python', '3.7'),
    ('SciPy-Stack', '2020b'),
]

builddependencies = [
    ('Boost', '1.72.0', '', ('GCC','9.3.0')),
    ('HDF5',  '1.10.6', '', ('GCC','9.3.0')),
    ('CMake', '3.18.4', '', True),
]

#preconfigopts = ' module load cmake/3.12.3 && '

separate_build_dir = True

# Replace shebang for a universal one to allow for the Python virtual environment in the user space
postinstallcmds = [
    "sed -i 's=^#!.*=#!/bin/env python=g' %(installdir)s/bin/psi4"
]

runtest = False

moduleclass = 'chem'
