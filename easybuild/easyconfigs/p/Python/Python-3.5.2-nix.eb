easyblock = 'Nix'

name = 'Python'
version = '3.5.2'
pyshortver = '.'.join(version.split('.')[:2])

homepage = 'http://python.org/'
description = "Python is a programming language that lets you work more quickly and integrate your systems more effectively."

toolchain = {'name': 'dummy', 'version': 'dummy'}

nix_profile = '/cvmfs/soft.computecanada.ca/nix/var/nix/profiles/python-%(version)s'
nix_attribute = 'python3 python35Packages.virtualenv python35Packages.pip python35Packages.wheel'

modextrapaths = {'PYTHONPATH': 'lib/python%s/site-packages' % pyshortver}

moduleclass = 'lang'

modluafooter = """
prepend_path("PYTHONPATH","/cvmfs/soft.computecanada.ca/custom/python/site-packages")
local archs = os.getenv("RSNT_ARCHS") or ""
for arch in archs:gmatch("%w+") do
	if arch == "avx2" then
		setenv("PIP_CONFIG_FILE", "/cvmfs/soft.computecanada.ca/config/python/pip-avx2.conf")
		break
	else
		setenv("PIP_CONFIG_FILE", "/cvmfs/soft.computecanada.ca/config/python/pip.conf")
	end
end
"""
